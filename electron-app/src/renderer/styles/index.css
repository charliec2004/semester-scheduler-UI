@tailwind base;
@tailwind components;
@tailwind utilities;

/* Base styles */
@layer base {
  :root {
    --focus-ring: 0 0 0 2px theme('colors.accent.500');
  }

  html {
    scroll-behavior: smooth;
    color-scheme: dark;
  }

  body {
    @apply font-sans bg-surface-950;
    font-feature-settings: 'liga' 1, 'calt' 1;
  }

  /* Custom title bar drag region */
  .titlebar-drag {
    -webkit-app-region: drag;
    app-region: drag;
  }

  .no-drag,
  .titlebar-drag button,
  .titlebar-drag a,
  .titlebar-drag input,
  .titlebar-drag select {
    -webkit-app-region: no-drag;
    app-region: no-drag;
  }

  /* Windows title bar overlay spacing */
  @supports (padding-top: env(titlebar-area-height, 0px)) {
    .titlebar-overlay-padding {
      padding-right: env(titlebar-area-width, 0px);
    }
  }

  /* High contrast mode */
  .high-contrast {
    --focus-ring: 0 0 0 3px theme('colors.warning.400');
  }

  .high-contrast .bg-surface-900 {
    @apply bg-black;
  }

  .high-contrast .text-surface-400 {
    @apply text-surface-200;
  }

  /* Focus styles for accessibility */
  *:focus-visible {
    outline: none;
    box-shadow: var(--focus-ring);
    @apply ring-2 ring-accent-500 ring-offset-2 ring-offset-surface-900;
  }

  /* Skip link for keyboard navigation */
  .skip-link {
    @apply absolute -top-10 left-4 z-50 bg-accent-500 text-surface-950 px-4 py-2 rounded-b-lg font-medium;
    @apply focus:top-0 transition-all;
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    @apply w-2 h-2;
  }

  ::-webkit-scrollbar-track {
    @apply bg-surface-900;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-surface-600 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-surface-500;
  }

  /* Selection */
  ::selection {
    @apply bg-accent-500/30 text-surface-100;
  }

  /* Number input spinners - hidden by default, show on hover/focus */
  input[type="number"]::-webkit-inner-spin-button,
  input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: inner-spin-button;
    appearance: auto;
    opacity: 0;
    cursor: pointer;
    filter: invert(0.6);
    transition: opacity 0.15s ease-in-out;
  }

  input[type="number"]:hover::-webkit-inner-spin-button,
  input[type="number"]:hover::-webkit-outer-spin-button,
  input[type="number"]:focus::-webkit-inner-spin-button,
  input[type="number"]:focus::-webkit-outer-spin-button {
    opacity: 1;
  }

  input[type="number"]::-webkit-inner-spin-button:hover,
  input[type="number"]::-webkit-outer-spin-button:hover {
    filter: invert(0.4);
  }
}

/* Component utilities */
@layer components {
  .btn {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg font-medium;
    @apply transition-all duration-200 ease-out;
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-accent-500 focus-visible:ring-offset-2 focus-visible:ring-offset-surface-900;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary {
    @apply btn bg-accent-600 text-white hover:bg-accent-500 active:bg-accent-700;
  }

  .btn-secondary {
    @apply btn bg-surface-700 text-surface-100 hover:bg-surface-600 active:bg-surface-800;
  }

  .btn-ghost {
    @apply btn bg-transparent text-surface-300 hover:bg-surface-800 hover:text-surface-100;
  }

  .btn-danger {
    @apply btn bg-danger-600 text-white hover:bg-danger-500 active:bg-danger-700;
  }

  .input {
    @apply w-full px-3 py-2 bg-surface-800 border border-surface-600 rounded-lg;
    @apply text-surface-100 placeholder-surface-500;
    @apply transition-all duration-200;
    @apply focus:outline-none focus:border-accent-500 focus:ring-1 focus:ring-accent-500;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .input-error {
    @apply border-danger-500 focus:border-danger-500 focus:ring-danger-500;
  }

  .label {
    @apply block text-sm font-medium text-surface-300 mb-1;
  }

  .card {
    @apply bg-surface-900 border border-surface-700 rounded-xl p-6;
    @apply transition-all duration-200;
  }

  .card-hover {
    @apply card hover:border-surface-600 hover:shadow-lg hover:shadow-surface-950/50;
  }

  /* Tab navigation */
  .tab {
    @apply px-4 py-3 text-sm font-medium text-surface-400;
    @apply border-b-2 border-transparent;
    @apply hover:text-surface-200 hover:border-surface-600;
    @apply transition-all duration-200;
  }

  .tab-active {
    @apply text-accent-400 border-accent-500;
  }

  /* Tooltip */
  .tooltip {
    @apply absolute z-50 px-2 py-1 text-xs bg-surface-800 text-surface-200 rounded shadow-lg;
    @apply opacity-0 invisible transition-all duration-200;
  }

  .tooltip-trigger:hover .tooltip,
  .tooltip-trigger:focus .tooltip {
    @apply opacity-100 visible;
  }

  /* Badge */
  .badge {
    @apply inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full;
  }

  .badge-success {
    @apply badge bg-accent-500/20 text-accent-400;
  }

  .badge-warning {
    @apply badge bg-warning-500/20 text-warning-400;
  }

  .badge-error {
    @apply badge bg-danger-500/20 text-danger-400;
  }

  .badge-info {
    @apply badge bg-surface-500/20 text-surface-300;
  }

  /* Grid styles for availability matrix */
  .availability-grid {
    @apply grid gap-px bg-surface-700;
  }

  .availability-cell {
    @apply w-6 h-6 flex items-center justify-center text-xs cursor-pointer;
    @apply transition-colors duration-100;
  }

  .availability-cell-available {
    @apply bg-accent-600 text-white hover:bg-accent-500;
  }

  .availability-cell-unavailable {
    @apply bg-surface-800 text-surface-500 hover:bg-surface-700;
  }

  /* Drop zone */
  .drop-zone {
    @apply border-2 border-dashed border-surface-600 rounded-xl p-8;
    @apply flex flex-col items-center justify-center gap-4;
    @apply transition-all duration-200;
  }

  .drop-zone-active {
    @apply border-accent-500 bg-accent-500/10;
  }

  /* Progress bar */
  .progress-bar {
    @apply h-2 bg-surface-700 rounded-full overflow-hidden;
  }

  .progress-bar-fill {
    @apply h-full bg-accent-500 transition-all duration-300 ease-out;
  }

  /* Log viewer */
  .log-viewer {
    @apply font-mono text-xs bg-surface-950 rounded-lg p-4 overflow-auto;
    @apply max-h-64 whitespace-pre-wrap;
  }

  .log-stdout {
    @apply text-surface-300;
  }

  .log-stderr {
    @apply text-danger-400;
  }

  /* Dark theme checkbox */
  .checkbox-dark {
    @apply w-4 h-4 rounded cursor-pointer;
    @apply appearance-none;
    @apply bg-surface-700 border border-surface-500;
    @apply transition-all duration-200;
    @apply focus:outline-none focus:ring-2 focus:ring-accent-500 focus:ring-offset-1 focus:ring-offset-surface-900;
  }

  .checkbox-dark:hover {
    @apply bg-surface-600 border-surface-400;
  }

  .checkbox-dark:checked {
    @apply bg-accent-600 border-accent-600;
    background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
    background-size: 100% 100%;
    background-position: center;
    background-repeat: no-repeat;
  }

  .checkbox-dark:checked:hover {
    @apply bg-accent-500 border-accent-500;
  }
}

/* Animation utilities */
@layer utilities {
  .animate-in {
    animation: fadeIn 0.3s ease-out forwards;
  }

  .stagger-1 { animation-delay: 50ms; }
  .stagger-2 { animation-delay: 100ms; }
  .stagger-3 { animation-delay: 150ms; }
  .stagger-4 { animation-delay: 200ms; }
  .stagger-5 { animation-delay: 250ms; }
}

/* Solver status message animations */
@keyframes statusShimmer {
  0% {
    background-position: 200% center;
  }
  100% {
    background-position: -200% center;
  }
}

@keyframes statusFadeSlide {
  0% {
    opacity: 0;
    transform: translateY(-6px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

.status-message-enter {
  display: inline-block;
  color: transparent;
  background: linear-gradient(
    90deg,
    #a1a1aa 0%,
    #a1a1aa 35%,
    #22d3ee 50%,
    #a1a1aa 65%,
    #a1a1aa 100%
  );
  background-size: 200% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  animation:
    statusFadeSlide 0.35s ease-out,
    statusShimmer 2.5s ease-in-out infinite;
}

/* Scrollbar gutter - prevents layout shift when scrollbar appears/disappears */
.scrollbar-gutter-stable {
  scrollbar-gutter: stable;
}

/* Font size variants for accessibility */
.font-size-small {
  font-size: 0.875rem;
}

.font-size-medium {
  font-size: 1rem;
}

.font-size-large {
  font-size: 1.125rem;
}
